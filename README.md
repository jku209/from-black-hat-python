Code from Black Hat Python
